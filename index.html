<!doctype html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="mobile-web-app-capable" content="yes"><title>AR Experience</title><script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script><script src="https://cdn.jsdelivr.net/npm/mind-ar@1.2.0/dist/mindar-image-aframe.prod.js"></script><style>*{margin:0;padding:0;box-sizing:border-box}body,html{width:100%;height:100%;margin:0;overflow:hidden;position:fixed;background-color:transparent}#loading-screen{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);width:90%;max-width:800px;height:90%;max-height:800px;background:#fff;background-size:contain;z-index:1000;display:flex;justify-content:center;align-items:center}.play-button{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);width:80px;height:80px;display:none;justify-content:center;align-items:center;cursor:pointer;z-index:1000;background:rgba(0,0,0,.3);border-radius:50%}.play-button::before{content:'';width:0;height:0;border-style:solid;border-width:20px 0 20px 40px;border-color:transparent transparent transparent rgba(255,255,255,.9);transform:translateX(5px);position:absolute}#loading-progress{position:fixed;bottom:20px;left:50%;transform:translateX(-50%);color:#fff;background:rgba(0,0,0,.5);padding:8px 16px;border-radius:20px;font-family:Arial,sans-serif;z-index:1000}#ar-scene{width:100vw;height:100vh;position:fixed;top:0;left:0;z-index:1;opacity:0;transition:opacity .5s ease}#ar-scene.ready{opacity:1}a-scene{background-color:transparent!important}</style><script defer="defer" src="./static/js/main.500f53ae.js"></script></head><body><div id="loading-screen"></div><div id="loading-progress">Loading...</div><div id="ar-scene"><a-scene mindar-image="imageTargetSrc: ./targets19.mind; filterMinCF:0.0001; filterBeta:0.001;" embedded renderer="colorManagement: true; alpha: true; antialias: true; precision: high;" vr-mode-ui="enabled: false" device-orientation-permission-ui="enabled: false" loading-screen="enabled: false"><a-camera position="0 0 0" look-controls="enabled: false"></a-camera><a-assets><video crossorigin="anonymous" id="video002" src="https://cdn.jsdelivr.net/gh/OsyaLdn/ar-scan-storage@master/003/003.mp4" preload="auto" loop playsinline webkit-playsinline></video></a-assets><a-entity mindar-image-target="targetIndex: 0"><a-gltf-model crossorigin="anonymous" rotation="0 0 0" position="0 0 0" src="https://cdn.jsdelivr.net/gh/OsyaLdn/ar-scan-storage@master/001/001.gltf"></a-gltf-model></a-entity><a-entity mindar-image-target="targetIndex: 2"><a-plane crossorigin="anonymous" width="1.5" height="1" position="0 0 0" rotation="0 0 0" material="transparent: true" video-material="video: #video002" visible="false"></a-plane></a-entity></a-scene></div><div id="playButton" class="play-button"></div><script>function performCleanup(e=!1){const t=document.querySelector("a-scene"),n=t?.systems["mindar-image-system"];if(document.querySelectorAll("video").forEach((t=>{if(t&&!t.paused&&(t.pause(),t.currentTime=0,e)){const e=t.src;t.src="",t.load(),setTimeout((()=>{t.src=e}),100)}})),t?.renderer){const e=t.renderer.getContext(),n=t.renderer.info.memory.textures||[];if(Array.isArray(n)&&n.forEach((e=>{e&&e.dispose&&e.dispose()})),e){const t=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS);for(let n=0;n<t;n++)e.activeTexture(e.TEXTURE0+n),e.bindTexture(e.TEXTURE_2D,null),e.bindTexture(e.TEXTURE_CUBE_MAP,null);e.bindBuffer(e.ARRAY_BUFFER,null),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null),e.bindRenderbuffer(e.RENDERBUFFER,null),e.bindFramebuffer(e.FRAMEBUFFER,null)}if(window.gc)try{window.gc()}catch(e){console.warn("GC not available")}}if(e&&n)try{n.stop(),setTimeout((()=>{n.start()}),1e3)}catch(e){console.warn("AR system cleanup error:",e)}return Promise.resolve()}const AROptimizer={lastCleanup:Date.now(),errorCount:0,isProcessing:!1,initialize(){this.setupAutoCleanup(),this.setupErrorHandling(),this.setupMemoryMonitoring()},setupAutoCleanup(){setInterval((()=>{document.hidden||this.isProcessing||(this.isProcessing=!0,performCleanup(!1).finally((()=>{this.isProcessing=!1})))}),12e4),setInterval((()=>{document.hidden||this.isProcessing||(this.isProcessing=!0,performCleanup(!0).finally((()=>{this.isProcessing=!1})))}),6e5)},setupErrorHandling(){const e=document.querySelector("a-scene");e&&e.addEventListener("arError",(async()=>{this.errorCount++,this.errorCount>3?(await performCleanup(!0),this.errorCount=0):await performCleanup(!1),setTimeout((()=>{this.errorCount=Math.max(0,this.errorCount-1)}),3e5)}))},setupMemoryMonitoring(){"memory"in performance&&setInterval((()=>{const{usedJSHeapSize:e,jsHeapSizeLimit:t}=performance.memory;e>.8*t&&(this.isProcessing||(this.isProcessing=!0,performCleanup(!0).finally((()=>{this.isProcessing=!1}))))}),3e4)}};AFRAME.registerComponent("video-material",{schema:{video:{type:"selector"}},init:function(){const e=this.el.getObject3D("mesh"),t=this.data.video,n=new THREE.VideoTexture(t);n.magFilter=THREE.LinearFilter,n.format=THREE.RGBAFormat;const i=new THREE.ShaderMaterial({vertexShader:"\n          varying vec2 vUv;\n          void main() {\n            vUv = uv;\n            gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n          }\n        ",fragmentShader:"\n          varying vec2 vUv;\n          uniform sampler2D videoTexture;\n          \n          void main() {\n            vec4 color = texture2D(videoTexture, vUv);\n            float dx = min(vUv.x, 1.0 - vUv.x);\n            float dy = min(vUv.y, 1.0 - vUv.y);\n            float edgeDistance = min(dx, dy);\n            float fadeWidth = 0.15;\n            float opacity = smoothstep(0.0, fadeWidth, edgeDistance);\n            float globalOpacity = 0.8;\n            gl_FragColor = vec4(color.rgb, color.a * opacity * globalOpacity);\n          }\n        ",uniforms:{videoTexture:{value:n}},transparent:!0,alphaTest:.01});e.material=i,this.el.addEventListener("componentremoved",(e=>{"video-material"===e.detail.name&&(i.uniforms.videoTexture.value&&i.uniforms.videoTexture.value.dispose(),i.dispose())}))}}),document.addEventListener("DOMContentLoaded",(function(){const e=document.getElementById("loading-progress"),t=document.getElementById("loading-screen"),n=document.getElementById("ar-scene"),i=document.querySelector("a-scene");t.style.display="flex",e.style.display="block",i.renderer.setClearColor(0,0),i.object3D.background=null;const r=[document.getElementById("video002")],o=[{video:document.getElementById("video002"),entity:document.querySelector('a-entity[mindar-image-target="targetIndex: 2"]'),plane:document.querySelector('a-entity[mindar-image-target="targetIndex: 2"] a-plane'),type:"video",loaded:!1},{model:document.querySelector('a-entity[mindar-image-target="targetIndex: 0"] a-gltf-model'),entity:document.querySelector('a-entity[mindar-image-target="targetIndex: 0"]'),type:"model",loaded:!1}];let a=null;AROptimizer.initialize(),setTimeout((()=>{e.textContent="Starting camera...",navigator.mediaDevices.getUserMedia({video:{facingMode:"environment",width:{ideal:1280},height:{ideal:720}},audio:!1}).then((function(s){function d(e){r.forEach((t=>{t&&t!==e&&(t.pause(),t.currentTime=0)}))}s.getTracks().forEach((e=>e.stop())),i.addEventListener("arReady",(function(){t.style.display="none",e.style.display="none",n.classList.add("ready")}));const l=document.getElementById("playButton");l.addEventListener("click",(()=>{if(a&&a.video){(async()=>{a.plane.setAttribute("visible",!0),l.style.display="none";try{await a.video.play()}catch(e){console.warn("Playback failed, retrying:",e),setTimeout((async()=>{try{await a.video.play()}catch(e){console.error("Retry failed:",e),l.style.display="flex",a.plane.setAttribute("visible",!1)}}),100)}})()}})),o.forEach((e=>{e.video&&(e.entity.addEventListener("targetFound",(()=>{a&&a!==e&&(a.video.pause(),a.video.currentTime=0,a.plane.setAttribute("visible",!1)),a=e,e.video.currentTime=0,d(e.video),e.plane.setAttribute("visible",!1),l.style.display="flex"})),e.entity.addEventListener("targetLost",(()=>{a===e&&(e.video.pause(),e.video.currentTime=0,l.style.display="none",e.plane.setAttribute("visible",!1),a=null)})),e.video.addEventListener("play",(()=>{d(e.video)})),e.video.addEventListener("ended",(()=>{e.video.loop&&(e.video.currentTime=0,e.video.play().catch((()=>{l.style.display="flex"})))})),e.video.addEventListener("error",(()=>{console.warn("Video error, attempting recovery"),a===e&&(l.style.display="none",e.plane.setAttribute("visible",!1));const t=e.video.src;e.video.src="",e.video.load(),e.video.src=t})),e.video.muted=!1)}))})).catch((function(t){console.error("Camera initialization error:",t),e.textContent="Camera permission denied"}))}),0)})),document.addEventListener("visibilitychange",(()=>{document.hidden&&performCleanup(!0)})),window.addEventListener("beforeunload",(()=>performCleanup(!0))),window.addEventListener("pagehide",(()=>performCleanup(!0)))</script></body></html>